# -*- coding: utf-8 -*-

def forward_elimination(A, b):
    """?????? ??? ?????? ??????: ?????????? ? ???????????? ????"""
    n = len(A)
    for i in range(n):
        # ???????? ??????? ??????? (???? ?????, ????? ???????? ????????? ?????)
        if A[i][i] == 0:
            for k in range(i + 1, n):
                if A[k][i] != 0:
                    A[i], A[k] = A[k], A[i]
                    b[i], b[k] = b[k], b[i]
                    break
        
        # ?????? ??????? ??????? ????????? ?????? 1 ? ???????? ????
        diag = A[i][i]
        for j in range(i, n):
            A[i][j] /= diag
        b[i] /= diag

        for k in range(i + 1, n):
            factor = A[k][i]
            for j in range(i, n):
                A[k][j] -= factor * A[i][j]
            b[k] -= factor * b[i]

def back_substitution(A, b):
    """???????? ??? ?????? ??????: ?????????? ???????"""
    n = len(A)
    x = [0] * n
    for i in range(n - 1, -1, -1):
        x[i] = b[i] - sum(A[i][j] * x[j] for j in range(i + 1, n))
    return x

def gaussian_elimination(A, b):
    """??????? ???? ??????? ??????"""
    forward_elimination(A, b)
    return back_substitution(A, b)

# ???????????? ???????
A = [
    [20, 5, 7, 1],
    [-1, 13, 0, -7],
    [4, -6, 17, 5],
    [-9, 8, 4, -25]
]

# ?????? ?????
b = [-117, -1, 49, -21]

# ??????? ???????
solution = gaussian_elimination(A, b)

# ????? ??????????
print("??????? ???????:", solution)


"""
import numpy as np

# ???????????? ???????
A = np.array([
    [20, 5, 7, 1],
    [-1, 13, 0, -7],
    [4, -6, 17, 5],
    [-9, 8, 4, -25]
])

# ?????? ?????? ?????
b = np.array([-117, -1, 49, -21])

# ?????? ??????? ?????????
x = np.linalg.solve(A, b)

# ??????? ?????????
print("??????? ???????:", x)
"""
